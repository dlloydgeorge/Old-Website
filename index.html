<!DOCTYPE html>
<html lang="eng">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuDecoDev</title>
    <link rel="stylesheet" href="css/styles.css">

</head>
<body>

    <!-- Add the Menu Bar-->
    <div class="navbar">
        <div class="title">
            <span>QuDeco</span>
        </div>
        <a href="index.html" class="active">Game</a>
        <a href="explanation.html">Background</a>
    </div>

    <div id="container">
        <div id="threeCanvas"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <!-- Main Game Script-->
    <script>
        // Set up scene
        const scene = new THREE.Scene();
        const FOV = 75;
        const Aspect = window.innerWidth / window.innerHeight
        const Near = 0.1
        const Far = 1000
        const camera = new THREE.PerspectiveCamera(FOV, Aspect, Near, Far);
        camera.position.set(2, 1, 5)
        //camera.position.x = 5;

        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('threeCanvas').appendChild(renderer.domElement);

        // Create Bloch Sphere with less dense wireframe
        const bloch_sphere_radius = 2;
        const sphereGeometry = new THREE.SphereGeometry(bloch_sphere_radius, 16, 16); // Adjust the number of segments here
        const sphereMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff, wireframe: true });
        const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
        scene.add(sphere);

        // Create Arrow
        /*
        const arrowGeometry = new THREE.CylinderGeometry(0, 0.05, 0.3, 20, 1);
        const arrowMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
        const arrow = new THREE.Mesh(arrowGeometry, arrowMaterial);
        arrow.position.set(2, 0, 0); // Initial position of the arrow
        scene.add(arrow);
        */
        const dir = new THREE.Vector3( 1, 2, 0 );
        dir.normalize();
        const origin = new THREE.Vector3( 0, 0, 0 );
        const length = bloch_sphere_radius;
        const hex = 0xffff00;
        const arrowHelper = new THREE.ArrowHelper( dir, origin, length, hex );
        scene.add( arrowHelper );


        // Add axes
        const axesHelper = new THREE.AxesHelper(5);
        scene.add(axesHelper);

        // Add ambient light
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        // Add directional light
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
        directionalLight.position.set(5, 3, 5);
        scene.add(directionalLight);

        // Function to animate the Bloch Sphere and Arrow
        function animate() {
            requestAnimationFrame(animate);
            // Rotate the arrow around the Bloch sphere
            const angle = Date.now() * 0.001; // Adjust speed of rotation
            //arrowHelper.position.x = 2 * Math.cos(angle);
            //arrowHelper.position.z = 2 * Math.sin(angle);
            arrowHelper.rotation.y = -angle;
            renderer.render(scene, camera);
        }

        animate();
        document.addEventListener('keydown', function(event) {
                    if (event.key === 'x') {
                        arrowHelper.rotation.y = Math.PI
                    }
                });
        // Adjust rendering when window is resized
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
